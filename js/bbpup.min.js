!function(a){var t;wp.media.wpUserAvatar={get:function(){return wp.media.view.settings.post.wpUserAvatarId},set:function(e){var i=wp.media.view.settings;i.post.wpUserAvatarId=e,i.post.wpUserAvatarSrc=a("div.attachment-info").find("img").attr("src"),i.post.wpUserAvatarId&&i.post.wpUserAvatarSrc&&(a("#wp-user-avatar"+t).val(i.post.wpUserAvatarId),a("#wpua-images"+t+", #wpua-undo-button"+t).show(),a("#wpua-preview"+t).find("img").attr("src",i.post.wpUserAvatarSrc).removeAttr("height",""),a("#wpua-remove-button"+t+", #wpua-thumbnail"+t).hide(),a("#wp_user_avatar_radio").trigger("click")),wp.media.wpUserAvatar.frame().close()},frame:function(){return this._frame?this._frame:(this._frame=wp.media({library:{type:"image"},multiple:!1,title:a("#wpua-add"+t).data("title")}),this._frame.on("open",function(){var e=a("#wp-user-avatar"+t).val();if(""==e)a("div.media-router").find("a:first").trigger("click");else{var i=this.state().get("selection");attachment=wp.media.attachment(e),attachment.fetch(),i.add(attachment?[attachment]:[])}},this._frame),this._frame.state("library").on("select",this.select),this._frame)},select:function(a){selection=this.get("selection").single(),wp.media.wpUserAvatar.set(selection?selection.id:-1)},init:function(){a("body").on("click","#wpua-add",function(a){a.preventDefault(),a.stopPropagation(),t="",wp.media.wpUserAvatar.frame().open()}),a("body").on("click","#wpua-add-existing",function(a){a.preventDefault(),a.stopPropagation(),t="-existing",wp.media.wpUserAvatar.frame().open()})}}}(jQuery),jQuery(function(a){"undefined"!=typeof wp&&wp.media.wpUserAvatar.init(),a("#your-profile").attr("enctype","multipart/form-data");var t=a("#wp-user-avatar").val(),e=a("#wpua-preview").find("img").attr("src");a("body").on("click","#wpua-remove",function(t){t.preventDefault(),a("#wpua-original").remove(),a("#wpua-remove-button, #wpua-thumbnail").hide(),a("#wpua-preview").find("img:first").hide(),a("#wpua-preview").prepend('<img id="wpua-original" />'),a("#wpua-original").attr("src",wpua_custom.avatar_thumb),a("#wp-user-avatar").val(""),a("#wpua-original, #wpua-undo-button").show(),a("#wp_user_avatar_radio").trigger("click")}),a("body").on("click","#wpua-undo",function(i){i.preventDefault(),a("#wpua-original").remove(),a("#wpua-images").removeAttr("style"),a("#wpua-undo-button").hide(),a("#wpua-remove-button, #wpua-thumbnail").show(),a("#wpua-preview").find("img:first").attr("src",e).show(),a("#wp-user-avatar").val(t),a("#wp_user_avatar_radio").trigger("click")})}),jQuery(function(a){"undefined"!=typeof wp&&wp.media.wpUserAvatar.init(),a("#your-profile").attr("enctype","multipart/form-data");var t=a("#wp-user-avatar-existing").val();a("body").on("click","#wpua-remove-existing",function(t){t.preventDefault(),a("#wpua-original-existing").remove(),a("#wpua-remove-button-existing, #wpua-thumbnail-existing").hide(),a("#wpua-original-existing").attr("src",wpua_custom.avatar_thumb),a("#wp-user-avatar-existing").val(""),a("#wpua-original-existing, #wpua-undo-button-existing").show(),a("#wp_user_avatar_radio").trigger("click")}),a("body").on("click","#wpua-undo-existing",function(e){e.preventDefault(),a("#wpua-original-existing").remove(),a("#wpua-images-existing").removeAttr("style"),a("#wpua-undo-button-existing").hide(),a("#wpua-remove-button-existing, #wpua-thumbnail-existing").show(),a("#wp-user-avatar-existing").val(t),a("#wp_user_avatar_radio").trigger("click")})});
